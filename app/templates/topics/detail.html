{% extends "base.html" %}

{% block content %}
  <div class="lesson-header">
    <div>
      <h1 class="page-title">{{ topic.title }}</h1>
      <p class="page-subtitle">
        Read carefully, then take the quiz to unlock the next topic.
        {% if topic.time %}<span class="lesson-time">‚è± {{ topic.time }}</span>{% endif %}
      </p>

      {% if is_anon %}
        <p class="muted" style="margin-top:8px;">
          üîê Create a free account to take quizzes, track progress, unlock topics, and earn a certificate.
          <a href="{{ url_for('auth.signup', next=request.path) }}">Sign up</a>
          or
          <a href="{{ url_for('auth.login', next=request.path) }}">Log in</a>.
        </p>
      {% endif %}
    </div>

    <div class="lesson-header-actions">
      <a class="btn btn-outline" href="{{ url_for('topics.list_topics') }}">‚Üê Back</a>

      {% if is_anon %}
        <a class="btn" href="{{ url_for('auth.login', next=url_for('quizzes.quiz', slug=topic.slug)) }}">
          Log in to take quiz
        </a>
      {% else %}
        <a class="btn" href="{{ url_for('quizzes.quiz', slug=topic.slug) }}">Take Quiz</a>
      {% endif %}
    </div>
  </div>

  <div class="lesson-layout">
    <article class="lesson-card">
      {% include "topics/content/" + content_template %}
    </article>

    <aside class="lesson-side">
      <div class="side-card">
        <div class="side-title">Quick checklist</div>
        <ul class="side-list">
          <li>Read the full lesson</li>
          <li>Note the red flags</li>
          <li>Take the quiz</li>
          <li>Pass to unlock next topic</li>
        </ul>
      </div>

      <div class="side-card">
        <div class="side-title">Tip</div>
        <p class="side-text">
          Don‚Äôt rush. Real safety comes from habits ‚Äî not just information.
        </p>
      </div>

      <div class="side-card">
        <div class="side-title">Next step</div>
        <p class="side-text">
          When you‚Äôre ready, click <strong>Take Quiz</strong>.
        </p>

        {% if is_anon %}
          <a class="btn" style="margin-top:10px; width:100%;" href="{{ url_for('auth.login', next=url_for('quizzes.quiz', slug=topic.slug)) }}">
            Log in to take quiz
          </a>
        {% else %}
          <a class="btn" style="margin-top:10px; width:100%;" href="{{ url_for('quizzes.quiz', slug=topic.slug) }}">
            Take Quiz
          </a>
        {% endif %}
      </div>
    </aside>
  </div>
{% endblock %}
